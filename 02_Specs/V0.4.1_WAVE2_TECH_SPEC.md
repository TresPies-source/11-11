# Dojo Genesis v0.4.1 - Wave 2 Tech Spec

**Author:** Manus AI (Dojo)
**Version:** 1.0
**Date:** January 2026
**Status:** Ready for Development

---

## 1. Overview

This document provides the technical specifications for **Wave 2** of the **Dojo Genesis v0.4.0 UI Unification & Polish** release, labeled as version **v0.4.1**. The goal of Wave 2 is to build the core interactive workflows of the application, leveraging the design system and layout established in Wave 1.

**Wave 2 Features:**
1.  **Workbench Redesign:** The primary prompt engineering and editing interface.
2.  **Agent Activity Panel:** A real-time panel to observe and interact with the agent system.
3.  **Librarian UI:** A full-page interface for searching and discovering knowledge.
4.  **Seeds UI:** A dedicated space for managing the user's personal knowledge seeds (Memory Garden).

**Guiding Principles:**
-   **Build on Wave 1:** All new components must use the established Visual Design System.
-   **Interactivity First:** Prioritize smooth, responsive, and intuitive user interactions.
-   **Data-Driven (with Mocks):** Design components to be data-driven, using mock data as placeholders where necessary.
-   **State Management:** Introduce client-side state management for UI state (e.g., panel visibility, selected tabs).

---

## 2. Workbench Redesign

**Objective:** Create a powerful and intuitive interface for writing, testing, and managing prompts.

**File Location:** `app/workbench/page.tsx`

### 2.1. Layout

-   **Main Container:** A 3-column layout: `[Sidebar (240px)] [Main Content (Flexible)] [Agent Panel (Resizable)]`.
-   **Resizable Panel:** The `Agent Activity Panel` on the right should be resizable. Use a library like `react-resizable-panels` for this functionality.

### 2.2. Components

1.  **Tab Bar (`/components/workbench/TabBar.tsx`)**
    -   **Functionality:** Allows users to switch between multiple open prompts.
    -   **State:** Manage the list of open tabs and the active tab ID in a client-side state management solution (e.g., Zustand or Jotai).
    -   **Component:** `Tab.tsx` for individual tabs, including a title and a close button.
    -   **Styling:** Active tab has an amber bottom border. A `[+]` button allows opening a new, empty prompt.

2.  **Prompt Editor (`/components/workbench/Editor.tsx`)**
    -   **Library:** Use `@monaco-editor/react` to embed the Monaco Editor.
    -   **Configuration:**
        -   **Theme:** Create a custom Monaco theme that matches the Dojo Genesis dark mode palette (`bg-bg-primary`, etc.).
        -   **Font:** Configure it to use `JetBrains Mono`.
        -   **Options:** Enable line numbers, minimap, and other standard editor features.
    -   **State:** The editor's content should be synced with the state of the active tab.

3.  **Action Bar (`/components/workbench/ActionBar.tsx`)**
    -   **Location:** Positioned below the editor.
    -   **Buttons:** Include three primary actions using the `Button` component from Wave 1:
        -   `[Test with Dojo]`: Primary action, `variant="primary"`.
        -   `[Save]`: Secondary action, `variant="secondary"`.
        -   `[Export]`: Secondary action, `variant="secondary"`.

### 2.3. State Management

-   A client-side state store (e.g., Zustand) should be created to manage the workbench state, including:
    -   `tabs`: An array of objects, each representing a prompt file (`id`, `title`, `content`).
    -   `activeTabId`: The ID of the currently visible tab.

---

## 3. Agent Activity Panel

**Objective:** Provide users with real-time observability into the agent system.

**File Location:** `/components/layout/AgentActivityPanel.tsx`

### 3.1. Layout and Resizing

-   **Default State:** Expanded, `width: 320px`.
-   **Collapsed State:** `width: 80px`.
-   **Resizing:** Implement a drag handle to resize the panel. The panel should snap to the collapsed state when dragged below a certain threshold (e.g., 150px).
-   **Toggle Button:** Include a button to programmatically collapse/expand the panel.

### 3.2. Components

1.  **Agent Card (`/components/agents/AgentCard.tsx`)**
    -   **Functionality:** A self-contained component to display the status of a single agent.
    -   **Props:** `agent: { id, name, icon, status, task }`.
    -   **Expanded View (`width > 150px`):**
        -   Display icon, name, status text, and current task.
        -   Include a `StatusDot` with pulsing animation if `status === 'working'`.
    -   **Collapsed View (`width <= 150px`):**
        -   Display only the agent icon and the `StatusDot`.

2.  **System Info (`/components/agents/SystemInfo.tsx`)**
    -   **Functionality:** Displays system-wide metrics.
    -   **Content:**
        -   **Cost:** `Cost: $0.0012` (use mock data).
        -   **Duration:** `Duration: 2s` (use mock data).

3.  **Activity Log (`/components/agents/ActivityLog.tsx`)**
    -   **Functionality:** A list of the most recent events from the agent system.
    -   **Content:** Display the last 5 events with timestamps (e.g., "Routing query... (0s ago)"). Use mock data.

### 3.3. State Management

-   The panel's state (expanded/collapsed, width) should be managed by the `react-resizable-panels` library or a simple client-side state.
-   Agent statuses and activity logs will be driven by mock data in this wave.

---

## 4. Librarian UI

**Objective:** Build a dedicated, full-page search experience for discovering prompts and seeds.

**File Location:** `app/librarian/page.tsx`

### 4.1. Layout

-   **Structure:** A standard two-column layout with the `Sidebar` on the left and the main content area on the right.
-   **Content:** A vertical layout containing the search bar and a list of results.

### 4.2. Components

1.  **Search Bar (`/components/librarian/SearchBar.tsx`)**
    -   **Styling:** A large, prominent search input field with a search icon (ðŸ”).
    -   **State:** The search query should be stored in local component state.

2.  **Results List (`/components/librarian/ResultsList.tsx`)**
    -   **Functionality:** Renders a list of `ResultCard` components.
    -   **Data:** Use a mock array of 10-15 search result objects.

3.  **Result Card (`/components/librarian/ResultCard.tsx`)**
    -   **Props:** `result: { type: 'prompt' | 'seed', title, description, similarity, tags, forks, lastUpdated }`.
    -   **Styling:** Use the `Card` component with the `glow` prop.
    -   **Content:**
        -   Icon (ðŸ“ for prompt, ðŸŒ± for seed).
        -   Title and description.
        -   **Similarity Score:** Displayed on the top-right (e.g., `95%`).
        -   **Tags:** A list of styled tag components.
        -   **Metadata:** Fork count and last updated timestamp.
        -   **Action Buttons:** `[View]`, `[Fork]`, `[Add to Workbench]` using the `Button` component.

---

## 5. Seeds UI (Memory Garden)

**Objective:** Create an interface for users to manage their personal knowledge seeds.

**File Location:** `app/seeds/page.tsx`

### 5.1. Layout

-   **Structure:** A full-page layout with a tabbed navigation system at the top.

### 5.2. Components

1.  **Seed Tabs (`/components/seeds/SeedTabs.tsx`)**
    -   **Functionality:** A tab group to filter seeds by status.
    -   **Tabs:** `[Keep]`, `[Grow]`, `[Compost]`, `[Replant]`.
    -   **Styling:** The active tab should have an amber bottom border.
    -   **State:** The active tab determines which list of seeds to display.

2.  **Seed List (`/components/seeds/SeedList.tsx`)**
    -   **Functionality:** Renders a list of `SeedCard` components based on the active tab.
    -   **Data:** Use a mock array of seed objects, each with a `status` property (`keep`, `grow`, etc.).

3.  **Seed Card (`/components/seeds/SeedCard.tsx`)**
    -   **Props:** `seed: { title, description, why, trigger }`.
    -   **Styling:** Use the base `Card` component.
    -   **Content:**
        -   Icon (ðŸŒ±).
        -   Title and description.
        -   `Why it matters:` text.
        -   `Revisit trigger:` text.
        -   **Action Buttons:** `[Move to Grow]`, `[Move to Compost]`, `[Replant]`.

4.  **Plant New Seed Button**
    -   A primary action button (`variant="primary"`) at the bottom of the page with the text `[+ Plant New Seed]`.

---

## 6. Success Criteria for Wave 2

-   âœ… The Workbench page is created with a functional tab bar and Monaco editor.
-   âœ… The Agent Activity Panel is implemented and can be resized and collapsed.
-   âœ… The Librarian page is created with a search bar and displays a list of mock search results.
-   âœ… The Seeds page is created with a tabbed interface and displays a list of mock seeds.
-   âœ… All new components are built using the Wave 1 design system and are fully responsive.
-   âœ… Client-side state is used appropriately to manage UI interactivity (e.g., active tabs, panel state).
-   âœ… The application remains stable, and all existing tests pass.
